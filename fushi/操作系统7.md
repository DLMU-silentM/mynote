# 操作系统第七章——设备管理

## 设备

目标：提高设备利用率

I/O系统：
- 设备
- 控制器
- 通道（具有通道的计算机系统）
- 总线
- I/O软件

### I/O系统

- 微机I/O系统
- 主机I/O系统

#### 微机I/O系统

I/O设备：
- 机械部分
- 电子部分（设备控制器或适配器）
  - 以印刷版电路形式擦汗如计算机总线插槽中
  - 如显卡

> 总线：
> - 分时
>   - 同一时刻只允许有一个部件向总线发送信息
> - 共享
>   - 总线上可以挂接多个部件，各个部件之间互相交换地信息都可通过这组线路分时共享
>   - 在某一时刻只允许有一个部件向总线发送信息，但多个部件可同时从总线上接收相问的信息

#### 主机I/O系统

不将设备直接来连接到CPU上，在I/O系统上加入了通道和控制器。

### I/O系统控制方式
- 程序控制I/O
  - 处理器向I/O设备发送命令
- 中断驱动I/O
  - 外设发出中断请求
- 直接存储访问I/O（DMA）
  - 由程序设置DMA控制器中的若干寄存器值（如内存始址，传送字节数），然后发起I/O操作，DMA控制器完成内存与外设的成批数据交换，在操作完成时由DMA控制器向CPU发面中断。
- 通道控制I/O
  - 通道：IO处理机
  - 能完成主存储器和外设之间的信息传输，并与中央处理机井行操作

### 设备分类
- 数据组织分类
  - 块设备
    1. 传输速率较高，通常为几兆位每秒
    2. 它是可寻址的，即可随机地读写任意一块
    3. 磁盘设备的I/O采用DMA方式
  - 字符设备
    1. 传输速率较低
    2. 不可寻址，即不能指定输入时的源地址或输出时的目标地址
    3. 字符设备的I/O常采用中断驱动方式。
- 资源分配角度
  - 独占设备
  - 共享设备
  - 虚拟设备
- 数据传输速率
  - 低速设备
  - 中速设备
  - 高速设备
- 输入输出对象
  - 人机通信设备
  - 机机通信设备
- 是否可交互
  - 非交互设备
  - 交互设备

### 设备管理目标和任务

目标：提高设备的利用率，为用户提供方便、统一的界面

任务：保证在多道程序环境下，当多个进程竞争使用设备时，按一定策略分配和管理各种设备，控制设备的各种操作，完成I/O设备与内存之间的数据交换

- 动态掌握并记录设备的状态
- 设备分配和释放
- 缓冲区管理
- 实现物理I/O设备的操作
- 提供设备使用的用户接口
- 设备的访问和控制
- I/O缓冲和调度